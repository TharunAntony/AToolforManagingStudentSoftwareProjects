<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Group Peer Reviews</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/convenor/navbar.css">
    <link rel="stylesheet" href="/css/convenor/viewGroupPeerReviews.css">
</head>
<body>

<div th:replace="fragments/navbar :: navbar"></div>

<div class="container">
    <h1 th:text="${project.title} + ' - ' + ${group.groupName}">Project Title - Group Name</h1>

    <div th:if="${reviews != null and !reviews.isEmpty()}">
        <table>
            <thead>
            <tr>
                <th>Reviewer</th>
                <th>Reviewee</th>
                <th>Score</th>
                <th>Comment</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="review : ${reviews}">
                <td th:text="${review.reviewer.firstName + ' ' + review.reviewer.lastName}"></td>
                <td th:text="${review.reviewee.firstName + ' ' + review.reviewee.lastName}"></td>
                <td th:text="${review.score}"></td>
                <td th:text="${review.comment}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <div class="mark-edit-section">
        <h2>Adjusted Marks</h2>

        <form th:action="@{'/convenor/' + ${project.id} + '/peerReviews/' + ${group.id} + '/updateMarks'}" method="post">
            <table>
                <thead>
                <tr>
                    <th>Student</th>
                    <th>Original Mark</th>
                    <th>Adjusted Mark</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="mark, i : ${marks}">
                    <td th:text="${mark.student.student.firstName + ' ' + mark.student.student.lastName}"></td>
                    <td th:text="${mark.originalMark}"></td>
                    <td>
                        <input type="hidden" th:name="|marks[${i.index}].id|" th:value="${mark.id}" />
                        <input type="number" step="0.01" min="0" max="100"
                               th:name="|marks[${i.index}].adjustedMark|"
                               th:value="${mark.adjustedMark}" />
                    </td>
                </tr>
                </tbody>
            </table>
            <button type="submit">Update Marks</button>
        </form>
    </div>

    <p th:if="${success}" th:text="${success}"></p>

    <div th:if="${reviews == null or reviews.isEmpty()}" class="no-reviews">
        <p>No peer reviews submitted for this group.</p>
    </div>


</div>

</body>
</html>
